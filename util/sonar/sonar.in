cleansonar:
	@echo "Cleaning sonar files..."
	@-find . -name "*.bak" -delete
	@-find . -name "*.log" -delete
	@-find . -name "*.xml" -delete
	@-find . -name ".coverage" -delete
	@-find . -name "python-coverage-html" -type d | xargs rm -fr
	@-find . -name "c-coverage-html" -type d | xargs rm -fr
	@-find . -name ".scannerwork" -type d | xargs rm -fr
	@-find $(UTIL)/sonar/build/ -name "*.json" -delete
	@-find $(UTIL)/sonar/build/ -name "*.log" -delete

coverage:runall
	@echo "Executing coverage..."
	@bash $(UTIL)/repo/deps.sh coverage
	@bash $(UTIL)/sonar/c-coverage.sh
	@bash $(UTIL)/sonar/python-coverage.sh

#all runall build coverage
sonar:build coverage
	@echo "Executing sonar-scanner..."
	@bash $(UTIL)/repo/deps.sh sonar-scanner
	@bash $(UTIL)/sonar/sonar.sh $(OPT)

build:
	@echo "Executing build-wrapper..."
	@bash $(UTIL)/repo/deps.sh build-wrapper
	@bash $(UTIL)/sonar/build.sh

sonarinstall:
	@echo "Installing sonar binaries..."
	@bash $(UTIL)/repo/deps.sh unzip
	@bash $(UTIL)/sonar/install.sh
